{"Shader":{"ver":"0.1","info":{"id":"sdlcDj","date":"1642745162","viewed":87,"name":" Sundown","username":"wyatt","description":"Repost, original broke","likes":12,"published":3,"flags":32,"usePreview":0,"tags":["sunset","fluid"],"hasliked":0},"renderpass":[{"inputs":[{"id":257,"src":"\/media\/previz\/buffer00.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":37,"channel":0}],"code":"Main {\n    U -= .5*R;\n    U *= .6\/(.8+.35*U.y\/R.y);\n    U += .5*R;\n    U.y += .15*R.y;\n    vec4 a = A(U),\n         n = A(U+vec2(0,1)),\n         e = A(U+vec2(1,0)),\n         s = A(U-vec2(0,1)),\n         w = A(U-vec2(1,0));\n    vec2 g = vec2(e.w-w.w,n.w-s.w);\n    float f = 0.;\n    vec2 u = U;\n    for (float i = -10.; i < 10.; i++) {\n        float w = pow(A(u).w,1.+.01*i);\n        f += w\/10.;\n        u = vec2(.5,0)*R+(u-vec2(.5,0)*R)*(1.-.005);\n    }\n    Q = .4+.4*sin(1.-3.*U.y\/R.y+5.*H\/R.y+vec4(1,2,3,4));\n    Q += 2.*H\/R.y;\n    vec2 d = normalize(vec2(.5,0)*R-U);\n    vec2 p = U;\n    float W = 0.;\n    for (float i = 0.; i < 200.; i++) {\n        p += 6.*d;\n        W += .01*A(p).w;\n    }\n    Q -= .4*W;\n    vec4 C = .8+.3*sin(W+1.\/(1.+a.w)+2.-3.*U.y\/R.y+3.*H\/R.y+vec4(1,2,3,4));\n    Q = mix(Q,C,f);\n    \/\/Q = vec4(0);\n    { \/\/ stars\n    for (float i = 1.;i < 5.; i++)\n    for (int k = 0; k < 9; k++) {\n        vec2 u = round(U)+vec2(k%3,k\/3)-1.;\n        vec3 h = hash(u)*2.-1.;\n        vec2 r = u-U+h.xy;\n        float l = 5.\/i*length(r);\n        Q += 8.\/i\/sqrt(i)*exp(-1e1*f)*10.*(1.+.5*sin(iTime+6.2*h.z))*exp(-5e1*l)*max(2.*U.y\/R.y-1.,0.);\n    }}\n\n}","name":"Image","description":"","type":"image"},{"inputs":[{"id":260,"src":"\/media\/previz\/buffer03.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":257,"channel":0}],"code":"vec4 T (vec2 U) {\n    return A(U-A(U).xy);\n}\nMain {\n    Q = T(U);\n    vec4 n = T(U+vec2(0,1)),\n         e = T(U+vec2(1,0)),\n         s = T(U-vec2(0,1)),\n         w = T(U-vec2(1,0));\n    Q.xy= Q.xy-.25*vec2(e.z-w.z,n.z-s.z);\n    Q.xy= Q.xy-.05*vec2(s.w-n.w,e.w-w.w);\n    Q.z = .25*(n.z+e.z+s.z+w.z-n.y-e.x+s.y+w.x);\n    Q.y += 1e-4*Q.w*(1.-2.*U.y\/R.y);\n    float h = H;\n    Q.w = mix(Q.w,1.,smoothstep(2.*h,h,U.y));\n    if(U.x<1.||R.x-U.x<1.) Q.xyw *= 0.;\n    if(U.y<1.||R.y-U.y<1.) Q.xyw *= 0.;\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[],"outputs":[],"code":"#define R iResolution.xy\n#define A(U) texture(iChannel0,(U)\/R)\n#define Main void mainImage(out vec4 Q, in vec2 U)\n#define H 50.*exp(-10.*(U.x-.5*R.x)*(U.x-.5*R.x)\/R.x\/R.x)\n#define ei(a) mat2(cos(a),-sin(a),sin(a),cos(a))\nvec3 hash (vec2 p)\n{\nvec3 p3 = fract(vec3(p.xyx) * vec3(.1031, .1030, .0973));\np3 += dot(p3, p3.yxz+33.33);\nreturn fract((p3.xxy+p3.yzz)*p3.zyx);\n}\nvec3 noise(vec2 p){\n    vec4 w = vec4(floor(p),ceil (p));\n    vec3 _00 = hash(w.xy),\n         _01 = hash(w.xw),\n         _10 = hash(w.zy),\n         _11 = hash(w.zw),\n         _0 = mix(_00,_01,fract(p.y)),\n         _1 = mix(_10,_11,fract(p.y));\n     return mix(_0,_1,fract(p.x));\n}\nvec3 fbm (vec2 p) {\n    vec3 w = vec3(0);\n    float N = 5.;\n    for (float i = 1.; i < N; i++) {\n        p *= 1.7*ei(.5);\n        w += noise(p)\/N\/i;\n    }\n    return w;\n}\n\n","name":"Common","description":"","type":"common"},{"inputs":[{"id":257,"src":"\/media\/previz\/buffer00.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":258,"channel":0}],"code":"vec4 T (vec2 U) {\n    return A(U-A(U).xy);\n}\nMain {\n    Q = T(U);\n    vec4 n = T(U+vec2(0,1)),\n         e = T(U+vec2(1,0)),\n         s = T(U-vec2(0,1)),\n         w = T(U-vec2(1,0));\n    Q.xy= Q.xy-.25*vec2(e.z-w.z,n.z-s.z);\n    Q.xy= Q.xy-.05*vec2(s.w-n.w,e.w-w.w);\n    Q.z = .25*(n.z+e.z+s.z+w.z-n.y-e.x+s.y+w.x);\n    Q.y += 1e-4*Q.w*(1.-2.*U.y\/R.y);\n    float h = H;\n    Q.w = mix(Q.w,1.,smoothstep(2.*h,h,U.y));\n    if(U.x<1.||R.x-U.x<1.) Q.xyw *= 0.;\n    if(U.y<1.||R.y-U.y<1.) Q.xyw *= 0.;\n}","name":"Buffer B","description":"","type":"buffer"},{"inputs":[{"id":258,"src":"\/media\/previz\/buffer01.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":259,"channel":0}],"code":"vec4 T (vec2 U) {\n    return A(U-A(U).xy);\n}\nMain {\n    Q = T(U);\n    vec4 n = T(U+vec2(0,1)),\n         e = T(U+vec2(1,0)),\n         s = T(U-vec2(0,1)),\n         w = T(U-vec2(1,0));\n    Q.xy= Q.xy-.25*vec2(e.z-w.z,n.z-s.z);\n    Q.xy= Q.xy-.05*vec2(s.w-n.w,e.w-w.w);\n    Q.z = .25*(n.z+e.z+s.z+w.z-n.y-e.x+s.y+w.x);\n    Q.y += 1e-4*Q.w*(1.-2.*U.y\/R.y);\n    float h = H;\n    Q.w = mix(Q.w,1.,smoothstep(2.*h,h,U.y));\n    if(U.x<1.||R.x-U.x<1.) Q.xyw *= 0.;\n    if(U.y<1.||R.y-U.y<1.) Q.xyw *= 0.;\n}","name":"Buffer C","description":"","type":"buffer"},{"inputs":[{"id":259,"src":"\/media\/previz\/buffer02.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":260,"channel":0}],"code":"vec4 T (vec2 U) {\n    return A(U-A(U).xy);\n}\nMain {\n    Q = T(U);\n    vec4 n = T(U+vec2(0,1)),\n         e = T(U+vec2(1,0)),\n         s = T(U-vec2(0,1)),\n         w = T(U-vec2(1,0));\n    Q.xy= Q.xy-.25*vec2(e.z-w.z,n.z-s.z);\n    Q.xy= Q.xy-.05*vec2(s.w-n.w,e.w-w.w);\n    Q.z = .25*(n.z+e.z+s.z+w.z-n.y-e.x+s.y+w.x);\n    Q.y += 1e-4*Q.w*(1.-2.*U.y\/R.y);\n    float h = H;\n    Q.w = mix(Q.w,1.,smoothstep(2.*h,h,U.y));\n    if(U.x<1.||R.x-U.x<1.) Q.xyw *= 0.;\n    if(U.y<1.||R.y-U.y<1.) Q.xyw *= 0.;\n}","name":"Buffer D","description":"","type":"buffer"}]}}