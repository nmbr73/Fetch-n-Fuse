{
 "ver": "0.1",
 "info": {
  "id": "NlScWt",
  "date": "0",
  "viewed": 0,
  "name": "ChampagneIceCream  JiPi671",
  "description": "Winning shader made at Revision 2022 Shader Showdown Final.\nLive coded on stage in 25 minutes.  Designed beforehand in several hours.\n\n",
  "likes": 0,
  "published": "Private",
  "usePreview": 0,
  "tags": [
   "line",
   "demoscene",
   "particles",
   "glow",
   "ice",
   "organic",
   "soft",
   "smooth",
   "spring",
   "particle",
   "merge",
   "cream",
   "spawn"
  ],
  "hasliked": 0,
  "parentid": "NlSyWt",
  "parentname": "Champagne ice cream"
 },
 "renderpass": [
  {
   "inputs": [],
   "outputs": [
    {
     "id": "4dfGRr",
     "channel": 0
    }
   ],
   "code": "// Winning shader made at Revision 2022 Shader Showdown final\n\n// This shader was coded live on stage in 25 minutes. Designed beforehand in several hours.\n\nvec2 z,v,e=vec2(.00035,-.00035);float t,tt,b,bb,s,gg,g; vec3 pp,tp,po,no,al,ld,lp,op;\nfloat smin(float a,float b,float k){float h=max(0.,k-abs(a-b));return min(a,b)-h*h*.25/k;}\nfloat smax(float a,float b,float k){float h=max(0.,k-abs(-a-b));return max(-a,b)+h*h*.25/k;}\nfloat cy(vec3 p,vec3 r){return max(abs(length(p.xz)-r.x)-r.y,abs(p.y)-r.z);}\nmat2 r2(float r){return mat2(cos(r),sin(r),-sin(r),cos(r));}\nvec2 smin( vec2 a, vec2 b,float k ){ float h=clamp(.5+.5*(b.x-a.x)/k,.0,1.);return mix(b,a,h)-k*h*(1.0-h);}\nvec2 fb( vec3 p,float ga){\n  b=sin(p.y*15.)*.03; //frill\n  vec2 h,d,t=vec2(length(p)-5.,0);   //blue base\n  t.x=smax(length(p.xz)-3.,t.x,.5);  //BASE CUT\n  pp=p; pp.xz*=r2(sin(p.y*.4-tt)*.4); //overall sway\n  pp.xz=abs(pp.xz)-3.;              //move out by 3\n  h=vec2(cy(pp,vec3(.5,.2,7.)),1);  //yellow tube\n  h.x=smin(h.x,cy(abs(pp)-.75,vec3(.2-b,.05,6.)),.5); //yellow 4 outter tubes\n  tp=pp;                //tp pp\n  tp.xz*=r2(.785);      //rot tp\n  tp=abs(tp);           //clone tp\n  tp.xz*=r2(.785);      //rot tp\n  tp.y=mod(tp.y,2.)-1.; //mod tp y\n  d=vec2(cy(tp.yxz,vec3(.1,0.01,2.5)),0.); //D cyl\n  tp.xz*=r2(.785);  //tp rot again\n  tp=abs(tp)-1.8;  //tp move out 1.8\n  d.x=smin(d.x,cy(tp,vec3(.1-b*.5,.05,3.)),.3); //d side cyl\n  d.x=max(d.x,abs(p.y)-6.); //Cut whole of D\n  pp.y=mod(pp.y-tt*2.,3.)-1.5;              //spore pp mod\n  pp.xz*=r2(-tt);                           //spore rot\n  pp.xz=abs(pp.xz)-max(0.,abs(p.y*.15)-1.5);//spore spread\n  s=length(pp)-.05;                         //spores\n  g+=0.5/(0.1+s*s*20.)*ga;                  //glo spores\n  h.x=smin(h.x,s,1.);                       //add spore to H\n  h.x=smin(h.x,length(pp.xz)-.02,.2);       //spores lines\n  h.x=smin(h.x,max(length(pp.xz)-20.,2.5),p.y*.5-5.); //spore tubes\n  t=smin(t,h,1.5);  //Add T and H\n  t=smin(t,d,.5); //Add T and D\n  tp.y=mod(p.y-tt*4.,4.)-2.; //PART tp mod p\n  h=vec2(length(tp),1); //PART TO H\n  gg+=0.2/(0.1+h.x*h.x*100.)*ga; //GLOW PART H\n  t=smin(t,h,0.5+p.y*.05); //Add T and H with p.y\n  t.x*=0.7; //AVOID ARTIFACT\nreturn t;\n}\nvec2 mp( vec3 p,float ga){\n  vec2 h,t=fb(p,ga);\n  h=fb(p*.3+vec3(0,3,0),ga);\n  h.x/=.3;\n  t=smin(h,t,1.5);\n  return t;\n}\nvec2 tr( vec3 ro,vec3 rd){\n  vec2 h,t=vec2(.1);\n  for(int i=0;i<128;i++){\n    h=mp(ro+rd*t.x,1.);\n    if(h.x<.0001||t.x>60.) break;\n    t.x+=h.x;t.y=h.y;\n  }\n  if(t.x>60.) t.y=-1.;\n\treturn t;\n}\n#define a(d) clamp(mp(po+no*d,0.).x/d,0.,1.)\n#define s(d) smoothstep(0.,1.,mp(po+ld*d,0.).x/d)\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ){\n  vec2 uv=(fragCoord.xy/iResolution.xy-0.5)/vec2(iResolution.y/iResolution.x,1);   \n  tt=mod(iTime,125.6637)*.5+3.94; \n  b=ceil(cos(tt*.4));\n  vec3 ro=mix(vec3(1.,10.+sin(tt*.4)*11.,cos(tt*.4)*2.),\n  vec3(cos(tt*.4)*8.,10.+sin(tt*.4)*12.,sin(tt*.4)*8.),b),\n  cw=normalize(vec3(0,12.+6.*b,0)-ro),\n  cu=normalize(cross(cw,vec3(0,1,0))),\n  cv=normalize(cross(cu,cw)),\n  rd=mat3(cu,cv,cw)*normalize(vec3(uv,.5)),co,fo;\n  co=fo=vec3(.17,.13,.12)-length(uv)*.2-rd.y*.1;\n  z=tr(ro,rd);t=z.x;\n  if(z.y>-1.){\n    po=ro+rd*t;\n    lp=ro;ld=normalize(lp-po);\n    no=normalize(e.xyy*mp(po+e.xyy,0.).x+e.yyx*mp(po+e.yyx,0.).x+e.yxy*mp(po+e.yxy,0.).x+e.xxx*mp(po+e.xxx,0.).x);\n    al=mix(vec3(.4,.6,.7),vec3(.7,.5,.3),z.y);\n    if(z.y>1.) al=vec3(1);\n    float dif=max(0.,dot(no,ld)),\n    fr=pow(1.+dot(no,rd),4.),\n    sp=pow(max(dot(reflect(-ld,no),-rd),0.),40.);\n    co=mix(sp+al*(a(.1)*a(.5)+.4)*(dif+s(2.)),fo,min(fr,.5));\n    co=mix(fo,co,exp(-.00004*t*t*t));\n  }\n  fragColor = vec4(pow(co+g*.2*vec3(.1,.2,.5)+gg*.2*vec3(.7,.5,.3),vec3(.55)),1);\n}",
   "name": "Image",
   "description": "",
   "type": "image"
  }
 ]
}