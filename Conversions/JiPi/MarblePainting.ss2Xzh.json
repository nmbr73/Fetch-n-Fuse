{"Shader":{"ver":"0.1","info":{"id":"ss2Xzh","date":"1619681253","viewed":450,"name":"Marble Painting","username":"wyatt","description":"Mouse to paint ! Thanks to Flexi for the inspiration","likes":25,"published":3,"flags":32,"usePreview":0,"tags":["fluid","automata"],"hasliked":0},"renderpass":[{"inputs":[{"id":257,"src":"\/media\/previz\/buffer00.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":259,"src":"\/media\/previz\/buffer02.png","ctype":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":260,"src":"\/media\/previz\/buffer03.png","ctype":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":37,"channel":0}],"code":"\/\/ Fork of \"Colors!\" by wyatt. https:\/\/shadertoy.com\/view\/7dX3z7\n\/\/ 2021-04-29 06:26:31\n\n\/\/ Fork of \"Transport Dynamics II\" by wyatt. https:\/\/shadertoy.com\/view\/sdl3RN\n\/\/ 2021-03-14 01:41:52\n\n\/\/ Display \ud83c\udf35\n\nMain \n{\n    float h = Paper(U);\n    Q = 1.5*D(U)+.8*C(U)*A(U).w;\n    Q = .8+h-Q;\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"#define R iResolution.xy\n#define A(U) texture(iChannel0,(U)\/R)\n#define B(U) texture(iChannel1,(U)\/R)\n#define C(U) texture(iChannel2,(U)\/R)\n#define D(U) texture(iChannel3,(U)\/R)\n#define Main void mainImage(out vec4 Q, in vec2 U)\n#define box for(int x=-1;x<=1;x++)for(int y=-1;y<=1;y++)\n#define r2 0.70710678118\nfloat hash(vec2 p) \/\/ Dave H\n{\n\tvec3 p3  = fract(vec3(p.xyx) * .1031);\n    p3 += dot(p3, p3.yzx + 33.33);\n    return fract((p3.x + p3.y) * p3.z);\n}\nfloat Paper (vec2 U) { \/\/https:\/\/www.shadertoy.com\/view\/NsfXWs\n    float h = .005*(sin(.6*U.x+.1*U.y)+sin(.7*U.y-.1*U.x));\n    for (float x = -1.; x<=1.;x++)\n    for (float y = -1.; y<=1.;y++){\n        h += .15*.125*hash(U+vec2(x,y));\n    }\n    return h;\n}","name":"Common","description":"","type":"common"},{"inputs":[{"id":258,"src":"\/media\/previz\/buffer01.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":259,"src":"\/media\/previz\/buffer02.png","ctype":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":257,"channel":0}],"code":"\/\/ Forces \ud83e\udd9c\nMain\n{\n    Q = A(U);\n    vec4 m = C(U);\n    float d = dot(m,vec4(-1,1,-1,1));\n    box if(x!=0||y!=0)\n    {\n        vec2 u = vec2(x,y);\n        vec4 a = A(U+u);\n        vec4 c = C(U+u);\n        float p = .1*Paper(U+u);\n        float f = length(m-c)*d;\n        Q.xy -= 0.05*a.w*(p+a.w-Q.w*f-1.)*u\/length(u);  \n    }\n    Q.w *= 1.-1e-4;\n    \/\/Q.y -= 1e-4*Q.w;\n    Q.xy *= 1.-exp(-10.*Q.w);\n    if (iMouse.z>0.&&length(U-iMouse.xy)<20.)\n        Q.w = 1.;\n    if (length(Q.xy)>.5) Q.xy = .5*normalize(Q.xy);\n    if (iFrame < 1)Q = vec4(0,0,0.,.05);\n    if (U.x < 4.||R.x-U.x<4.) Q.xy *= 0.;\n    if (U.y < 4.||R.y-U.y<4.) Q.xy *= 0.;\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":257,"src":"\/media\/previz\/buffer00.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":258,"channel":0}],"code":"\/\/ Advect \ud83d\udc3f\nMain\n{\n    Q = A(U);\n    vec4 dQ = vec4(0);\n    box if(abs(x)!=abs(y))\n    {\n        vec2 u = vec2(x,y);\n        vec4 q = A(U+u);\n        vec2 a = Q.xy,\n             b = q.xy+u;\n       float ab = dot(u,b-a);\n       float i = dot(u,(0.5*u-a))\/ab;\n       float j = .5+.5*max(1.-Q.w*q.w,0.);\n       float k = .5+.5*max(1.-Q.w*q.w,0.);\n       float wa = 0.25*Q.w*min(i,j)\/j;\n       float wb = 0.25*q.w*max(k+i-1.,0.)\/k;\n        dQ.xyz += Q.xyz*wa+q.xyz*wb;\n        dQ.w += wa+wb;\n        \n    }\n    if (dQ.w>0.)dQ.xyz\/=dQ.w;\n    Q = dQ;\n    \n    if (U.x < 4.||R.x-U.x<4.) Q.xy *= 0.;\n    if (U.y < 4.||R.y-U.y<4.) Q.xy *= 0.;\n}","name":"Buffer B","description":"","type":"buffer"},{"inputs":[{"id":258,"src":"\/media\/previz\/buffer01.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":259,"src":"\/media\/previz\/buffer02.png","ctype":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":259,"channel":0}],"code":"\/\/ Advect \ud83d\udc3f\nMain\n{\n    Q = A(U);\n    vec4 Qb = B(U);\n    vec4 dQ = vec4(0);\n    box if(abs(x)!=abs(y))\n    {\n        vec2 u = vec2(x,y);\n        vec4 q = A(U+u),\n             qb = B(U+u);\n        vec2 a = Q.xy,\n             b = q.xy+u;\n       float ab = dot(u,b-a);\n       float i = dot(u,(0.5*u-a))\/ab;\n       float j = .5;\n       float k = .5;\n       float wa = 0.25*Q.w*min(i,j)\/j;\n       float wb = 0.25*q.w*max(k+i-1.,0.)\/k;\n        dQ.xyz += Qb.xyz*wa+qb.xyz*wb;\n        dQ.w += wa+wb;\n        \n    }\n    if (dQ.w>0.)dQ.xyz\/=dQ.w;\n    Q = dQ;\n    if (iMouse.z>0.&&length(U-iMouse.xy)<20.)\n        Q = 0.5+0.5*sin(vec4(1,2,3,4)+iTime);\n    if (iFrame<1)\n        Q = 0.5+0.5*sin(vec4(1,2,3,4)*4.*length(U-0.5*R)\/R.x);\n}","name":"Buffer C","description":"","type":"buffer"},{"inputs":[{"id":257,"src":"\/media\/previz\/buffer00.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":259,"src":"\/media\/previz\/buffer02.png","ctype":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":260,"src":"\/media\/previz\/buffer03.png","ctype":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":260,"channel":0}],"code":"Main {\n    Q = D(U);\n    vec4 a = A(U);\n    vec4 c = C(U)*a.w;\n    \n    Q = mix(Q,c,.001*a.w*a.w);\n    \n}","name":"Buffer D","description":"","type":"buffer"}]}}