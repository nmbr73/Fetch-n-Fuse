{"Shader":{"ver":"0.1","info":{"id":"NtGXDG","date":"1641272883","viewed":114,"name":"Night Escape","username":"wyatt","description":"Sometimes sophia lets me leave at night.","likes":15,"published":3,"flags":0,"usePreview":0,"tags":["fbm"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"id":37,"channel":0}],"code":"Main \n\n U = 2.*(U-.5*R)\/R.y;\n float d = 1.+1.9*(U.y);\n vec2 u = U*3.\/d;\n if (d<0.) {\n    u=-u;\n    u.x += .01*sin(-T+1.*u.x)*sin(3.*u.y);\n    u.y += .05*sin(1.*u.x)*sin(1.*u.y);\n    U.x += .05*sin(-T+5.*u.x)*sin(60.*u.y);\n    U.y += .05*sin(1.*u.x)*sin(1.*u.y);\n }\n d = abs(d);\n u.x += sin(u.y);\n float cloud = clamp(1.-.01*(pow(5.*fbmt(10.+u+.01*T),3.)),0.,1.);\n float night = .8*clamp(.5-.05*u.x,0.,1.);\n float stars = .5+.5*clamp(2e6*pow(fbm(29.*u),15.),0.,1.);\n vec4 sunset = .2+.5*sin(-.9-.1*u.y+2e-2*u.x+vec4(1,2,3,4));\n sunset = mix(sunset,2.-2.*vec4(stars),night);\n Q = mix(vec4(exp(-.01*u.x*u.x)),sunset,cloud);\n float mountain = 17.*pow(fbm(vec2(10.+.05*U.x,0)),7.);\n Q *= vec4(1.-step(d-mountain,0.));\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"vec2 R; float T; int I;\n#define Main void mainImage(out vec4 Q, in vec2 U) {R = iResolution.xy; T = iTime; I = iFrame;\n#define ei(a) mat2(cos(a),-sin(a),sin(a),cos(a))\nfloat hash(vec2 p)\n{\n\tvec3 p3  = fract(vec3(p.xyx) * .1031);\n    p3 += dot(p3, p3.yzx + 33.33);\n    return fract((p3.x + p3.y) * p3.z);\n}\nfloat noise(vec2 p)\n{\n    vec4 w = vec4(\n        floor(p),\n        ceil (p)  );\n    float \n        _00 = hash(w.xy),\n        _01 = hash(w.xw),\n        _10 = hash(w.zy),\n        _11 = hash(w.zw),\n    _0 = mix(_00,_01,fract(p.y)),\n    _1 = mix(_10,_11,fract(p.y));\n    return mix(_0,_1,fract(p.x));\n}\nfloat fbmt (vec2 p) {\n    float w = 0.;\n    #define N 11.\n    for (float i = 0.; i < N; i++)\n    {\n        p *= 1.7*ei(1e-3*T);\n        w += noise(p)\/N;\n    }\n    return w;\n}\nfloat fbm (vec2 p) {\n    float w = 0.;\n    #define N 11.\n    for (float i = 0.; i < N; i++)\n    {\n        p *= 1.7*ei(.5);\n        w += noise(p)\/N;\n    }\n    return w;\n}\nvec4 pw (vec4 p, float a) {\n    return vec4(pow(p.x,a),pow(p.y,a),pow(p.z,a),pow(p.w,a));\n}","name":"Common","description":"","type":"common"}]}}