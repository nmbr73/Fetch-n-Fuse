{"Shader":{"ver":"0.1","info":{"id":"XtBfz1","date":"1514497895","viewed":2804,"name":"100000 Pins Valley","username":"aiekick","description":"100000 Pins Valley","likes":31,"published":3,"flags":0,"usePreview":0,"tags":["valley","100000","pins"],"hasliked":0},"renderpass":[{"inputs":[],"outputs":[{"id":37,"channel":0}],"code":"float df(vec3 p)\n{\n\tfloat a = p.z * cos(p.z * 2.0) * 0.001;\n\tp.xy *= mat2(cos(a),sin(a),-sin(a), cos(a));\n\tp.y += sin(p.x * .5 + p.z * 0.5);\n\tfloat sp = 10. - abs(p.y * 0.5);\n\tfloat cy = max(1.0-0.2*sin(p.z*0.5)-abs(p.y*0.5),length(mod(p.xz, 1.)-0.5) - 0.2);\n    return min(sp,cy);\n}\n\nvec3 nor( vec3 pos, float prec )\n{\n\tvec3 eps = vec3( prec, 0., 0. );\n\tvec3 nor = vec3(\n\t    df(pos+eps.xyy) - df(pos-eps.xyy),\n\t    df(pos+eps.yxy) - df(pos-eps.yxy),\n\t    df(pos+eps.yyx) - df(pos-eps.yyx) );\n\treturn normalize(nor);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 g = fragCoord;\n\tvec2 si = iResolution.xy;\n\tvec2 uv = (g+g-si)\/si.y\/0.8;\n\tvec3 ro = vec3(0,0, (iTime + 30.) * 2.); \n    vec3 cv = ro + vec3(0,0,1); \n\tvec3 cu = normalize(vec3(0,1,0));\n  \tvec3 z = normalize(cv-ro);\n    vec3 x = normalize(cross(cu,z));\n  \tvec3 y = cross(z,x);\n    float fov = .9;\n  \tvec3 rd = normalize(fov * (uv.x * x + uv.y * y) + z);\n\t\n\tfloat s = 1., d = 0.;\n\tfor (int i=0; i<150; i++) \n\t{\n\t\tif (log(d*d\/s\/1e6)>0.) break;\n\t\ts=df(ro+rd*d);\n\t\td += s * .15;\n\t}\n\t\n\tvec3 p = ro + rd * d;\n\tvec3 lid = normalize(ro-p);\n\tvec3 n = nor(p, 0.1);\n\tvec3 refl = reflect(rd,n);\n\tfloat diff = clamp( dot( n, lid ), 0.0, 1.0 );\n\tfloat fre = pow( clamp( 1. + dot(n,rd),0.0,1.0), 4. );\n\tfloat spe = pow(clamp( dot( refl, lid ), 0.0, 1.0 ),16.);\n\tvec3 col = vec3(.8,.5,.2);\n    \n    float sss = df(p - n*0.001)\/0.05;\n\t\n\tfragColor.rgb = mix(\n\t(diff * vec3(0.8,0.2,0.5) + fre + sss * vec3(0.8,0.5,0.5)) * 0.25,\n\tvec3(spe * 0.5), \n\texp(-0.01 * d*d));\n\n\tvec2 q = g\/si;\n    fragColor.rgb *= 0.5 + 0.5*pow( 16.0*q.x*q.y*(1.0-q.x)*(1.0-q.y), 0.55 );\n}\n","name":"Image","description":"","type":"image"}]}}