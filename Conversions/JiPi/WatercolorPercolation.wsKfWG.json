{"Shader":{"ver":"0.1","info":{"id":"wsKfWG","date":"1607892301","viewed":490,"name":"Watercolor Percolation","username":"wyatt","description":"These people did it wayy better : https:\/\/grail.cs.washington.edu\/projects\/watercolor\/paper_tiny.pdf","likes":26,"published":3,"flags":32,"usePreview":0,"tags":["watercolor"],"hasliked":0},"renderpass":[{"inputs":[{"id":257,"src":"\/media\/previz\/buffer00.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":258,"src":"\/media\/previz\/buffer01.png","ctype":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":37,"channel":0}],"code":"Main {\n    vec4 a = A(U), b = B(U);\n    Q = a+b;\n    float n = hash(U+vec2(0,1));\n    float e = hash(U+vec2(1,0));\n    float s = hash(U-vec2(0,1));\n    float w = hash(U-vec2(1,0));\n    vec3 no = normalize(vec3(e-s,n-s,1));\n    \n    Q = .9+.05*no.y-sqrt(Q);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"#define R iResolution.xy\n#define A(U) texture(iChannel0,(U)\/R)\n#define B(U) texture(iChannel1,(U)\/R)\n#define C(U) texture(iChannel2,(U)\/R)\n#define D(U) texture(iChannel3,(U)\/R)\n#define Main void mainImage(out vec4 Q, in vec2 U)\nfloat ln (vec2 p, vec2 a, vec2 b) { \/\/ returns distance to line segment for mouse input\n    return length(p-a-(b-a)*clamp(dot(p-a,b-a)\/dot(b-a,b-a),0.,1.));\n}\nfloat ln (vec3 p, vec3 a, vec3 b) { \/\/ returns distance to line segment for mouse input\n    return length(p-a-(b-a)*dot(p-a,b-a)\/dot(b-a,b-a));\n}\nfloat hash (vec2 p) \/\/ Dave H\n{\n\tvec3 p3  = fract(vec3(p.xyx) * .1031);\n    p3 += dot(p3, p3.yzx + 33.33);\n    return fract((p3.x + p3.y) * p3.z);\n}","name":"Common","description":"","type":"common"},{"inputs":[{"id":5,"src":"\/media\/a\/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg","ctype":"texture","channel":1,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":259,"src":"\/media\/previz\/buffer02.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":260,"src":"\/media\/previz\/buffer03.png","ctype":"buffer","channel":3,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":257,"channel":0}],"code":"Main {\n    Q = A(U+vec2(0,1));\n    Q = A(U+vec2(0,.05*length(Q.xyz)*Q.w));\n    vec4 q = vec4(0);\n    for (int x = -1; x<= 1; x++)\n    for (int y = -1; y<= 1; y++)\n    if (x!=0||y!=0)\n    {\n        vec2 u = vec2(x,y);\n        vec4 a = A(U+u);\n        float h = hash(U+0.5*u);\n        float m = (length(a.xyz));\n        m = min(m,1.);\n        vec4 w = vec4(atan(Q.w*a.www),a.w);\n        q += m*pow(h,6.)*(a-Q)\/dot(u,u);\n    }\n    Q += 0.125*q;\n    \n    vec4 d = D(U);\n    if (iMouse.z>0.&&ln(U,d.xy,d.zw)<.025*R.y){\n        Q = 0.5+0.5*sin(iTime+vec4(1,2,3,4));\n        Q.w = 1.;\n    }\n    \/\/if (iFrame < 1) Q = 1.-B(U);\n    \n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":257,"src":"\/media\/previz\/buffer00.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":258,"src":"\/media\/previz\/buffer01.png","ctype":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":258,"channel":0}],"code":"Main {\n\n    Q = B(U);\n    Q += 5e-4*A(U);\n    \n}","name":"Buffer B","description":"","type":"buffer"},{"inputs":[{"id":257,"src":"\/media\/previz\/buffer00.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":259,"channel":0}],"code":"Main {\n    Q = A(U)*(1.-5e-4);\n}","name":"Buffer C","description":"","type":"buffer"},{"inputs":[{"id":260,"src":"\/media\/previz\/buffer03.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":260,"channel":0}],"code":"\/\/Mouse\nvoid mainImage( out vec4 C, in vec2 U )\n{\n    vec4 p = texture(iChannel0,U\/iResolution.xy);\n   \tif (iMouse.z>0.) {\n      if (p.z>0.) C =  vec4(iMouse.xy,p.xy);\n    else C =  vec4(iMouse.xy,iMouse.xy);\n   }\n    else C = vec4(-iResolution.xy,-iResolution.xy);\n}","name":"Buffer D","description":"","type":"buffer"}]}}