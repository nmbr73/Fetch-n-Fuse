
// ----------------------------------------------------------------------------------
// - Common                                                                         -
// ----------------------------------------------------------------------------------
#define texture(ch,uv) _tex2DVecN(ch, (uv).x, (uv).y, 15)

//const float2 path[] = {to_float2(-0.345f, 0.16333333333333333f), to_float2(-0.345f, 0.195f), to_float2(-0.345f, 0.22666666666666666f), to_float2(-0.3616666666666667f, 0.24333333333333335f), to_float2(-0.3883333333333333f, 0.25f), to_float2(-0.4166666666666667f, 0.255f), to_float2(-0.4483333333333333f, 0.255f), to_float2(-0.48f, 0.255f), to_float2(-0.5116666666666667f, 0.255f), to_float2(-0.54f, 0.25f), to_float2(-0.56f, 0.235f), to_float2(-0.5833333333333334f, 0.21166666666666667f), to_float2(-0.6066666666666667f, 0.18666666666666668f), to_float2(-0.6116666666666667f, 0.155f), to_float2(-0.6116666666666667f, 0.12f), to_float2(-0.6033333333333334f, 0.09166666666666666f), to_float2(-0.5866666666666667f, 0.06f), to_float2(-0.5666666666666667f, 0.04f), to_float2(-0.5516666666666666f, 0.02f), to_float2(-0.5316666666666666f, 0.0f), to_float2(-0.5033333333333333f, -0.0033333333333333335f), to_float2(-0.4716666666666667f, -0.0033333333333333335f), to_float2(-0.44f, -0.0033333333333333335f), to_float2(-0.44f, -0.0033333333333333335f), to_float2(-0.4766666666666667f, -0.0033333333333333335f), to_float2(-0.5083333333333333f, -0.015f), to_float2(-0.5316666666666666f, -0.03166666666666667f), to_float2(-0.5516666666666666f, -0.04666666666666667f), to_float2(-0.5666666666666667f, -0.06333333333333334f), to_float2(-0.5833333333333334f, -0.07833333333333334f), to_float2(-0.595f, -0.09833333333333333f), to_float2(-0.595f, -0.13333333333333333f), to_float2(-0.58f, -0.16166666666666665f), to_float2(-0.56f, -0.18166666666666667f), to_float2(-0.5316666666666666f, -0.20166666666666666f), to_float2(-0.48333333333333334f, -0.225f), to_float2(-0.4483333333333333f, -0.24166666666666667f), to_float2(-0.4166666666666667f, -0.245f), to_float2(-0.385f, -0.245f), to_float2(-0.325f, -0.23f), to_float2(-0.2816666666666667f, -0.21333333333333335f), to_float2(-0.25333333333333335f, -0.19f), to_float2(-0.23f, -0.16166666666666665f), to_float2(-0.21f, -0.13333333333333333f), to_float2(-0.195f, -0.10166666666666667f), to_float2(-0.17f, -0.075f), to_float2(-0.14666666666666667f, -0.035f), to_float2(-0.14333333333333334f, 0.0f), to_float2(-0.13166666666666665f, 0.065f), to_float2(-0.13166666666666665f, 0.09666666666666666f), to_float2(-0.13166666666666665f, 0.12833333333333333f), to_float2(-0.13166666666666665f, 0.16f), to_float2(-0.13166666666666665f, 0.195f), to_float2(-0.13833333333333334f, 0.22666666666666666f), to_float2(-0.155f, 0.25f), to_float2(-0.17833333333333334f, 0.2633333333333333f), to_float2(-0.20166666666666666f, 0.24666666666666667f), to_float2(-0.21f, 0.21166666666666667f), to_float2(-0.21f, 0.175f), to_float2(-0.20166666666666666f, 0.11666666666666667f), to_float2(-0.20166666666666666f, 0.07166666666666667f), to_float2(-0.20166666666666666f, 0.03666666666666667f), to_float2(-0.20166666666666666f, 0.0f), to_float2(-0.19833333333333333f, -0.035f), to_float2(-0.18666666666666668f, -0.06333333333333334f), to_float2(-0.175f, -0.09f), to_float2(-0.16333333333333333f, -0.13f), to_float2(-0.155f, -0.15833333333333333f), to_float2(-0.14333333333333334f, -0.185f), to_float2(-0.11833333333333333f, -0.205f), to_float2(-0.10333333333333333f, -0.22166666666666668f), to_float2(-0.075f, -0.21333333333333335f), to_float2(-0.051666666666666666f, -0.18166666666666667f), to_float2(-0.035f, -0.16166666666666665f), to_float2(-0.03166666666666667f, -0.13333333333333333f), to_float2(-0.023333333333333334f, -0.10166666666666667f), to_float2(-0.011666666666666667f, -0.055f), to_float2(-0.011666666666666667f, -0.023333333333333334f), to_float2(-0.011666666666666667f, 0.013333333333333334f), to_float2(-0.011666666666666667f, 0.045f), to_float2(-0.011666666666666667f, 0.07666666666666666f), to_float2(-0.011666666666666667f, 0.045f), to_float2(-0.011666666666666667f, 0.008333333333333333f), to_float2(-0.011666666666666667f, -0.02666666666666667f), to_float2(-0.008333333333333333f, -0.06333333333333334f), to_float2(0.011666666666666667f, -0.08666666666666667f), to_float2(0.035f, -0.10166666666666667f), to_float2(0.06f, -0.095f), to_float2(0.08666666666666667f, -0.07f), to_float2(0.10666666666666667f, -0.05f), to_float2(0.11166666666666666f, -0.018333333333333333f), to_float2(0.115f, 0.008333333333333333f), to_float2(0.11833333333333333f, 0.03666666666666667f), to_float2(0.11833333333333333f, 0.06833333333333333f), to_float2(0.135f, 0.03666666666666667f), to_float2(0.12333333333333334f, 0.008333333333333333f), to_float2(0.11166666666666666f, -0.018333333333333333f), to_float2(0.11166666666666666f, -0.05f), to_float2(0.11166666666666666f, -0.08333333333333333f), to_float2(0.11166666666666666f, -0.115f), to_float2(0.11166666666666666f, -0.15333333333333332f), to_float2(0.11166666666666666f, -0.19f), to_float2(0.11166666666666666f, -0.23333333333333334f), to_float2(0.11166666666666666f, -0.2683333333333333f), to_float2(0.10666666666666667f, -0.3f), to_float2(0.095f, -0.3333333333333333f), to_float2(0.08333333333333333f, -0.365f), to_float2(0.055f, -0.39166666666666666f), to_float2(0.023333333333333334f, -0.4033333333333333f), to_float2(0.0033333333333333335f, -0.37166666666666665f), to_float2(0.0033333333333333335f, -0.34f), to_float2(0.016666666666666666f, -0.31666666666666665f), to_float2(0.04f, -0.285f), to_float2(0.055f, -0.25666666666666665f), to_float2(0.075f, -0.21666666666666667f), to_float2(0.095f, -0.17f), to_float2(0.10666666666666667f, -0.13833333333333334f), to_float2(0.12666666666666668f, -0.09f), to_float2(0.14666666666666667f, -0.058333333333333334f), to_float2(0.17f, -0.03166666666666667f), to_float2(0.195f, -0.006666666666666667f), to_float2(0.215f, 0.016666666666666666f), to_float2(0.235f, 0.03666666666666667f), to_float2(0.26166666666666666f, 0.04833333333333333f), to_float2(0.29333333333333333f, 0.04833333333333333f), to_float2(0.285f, 0.051666666666666666f), to_float2(0.25f, 0.045f), to_float2(0.235f, 0.02f), to_float2(0.23833333333333334f, -0.018333333333333333f), to_float2(0.24666666666666667f, -0.058333333333333334f), to_float2(0.26666666666666666f, -0.095f), to_float2(0.29833333333333334f, -0.115f), to_float2(0.3333333333333333f, -0.08333333333333333f), to_float2(0.35f, -0.06333333333333334f), to_float2(0.3566666666666667f, -0.02666666666666667f), to_float2(0.3566666666666667f, 0.008333333333333333f), to_float2(0.345f, 0.03666666666666667f), to_float2(0.325f, 0.051666666666666666f), to_float2(0.3016666666666667f, 0.065f), to_float2(0.3333333333333333f, 0.06f), to_float2(0.3566666666666667f, 0.045f), to_float2(0.36833333333333335f, 0.013333333333333334f), to_float2(0.36833333333333335f, -0.035f), to_float2(0.36833333333333335f, -0.07f), to_float2(0.37666666666666665f, -0.10166666666666667f), to_float2(0.405f, -0.115f), to_float2(0.4483333333333333f, -0.075f), to_float2(0.46f, -0.03166666666666667f), to_float2(0.4683333333333333f, 0.02f), to_float2(0.4716666666666667f, 0.08f), to_float2(0.4716666666666667f, 0.135f), to_float2(0.4716666666666667f, 0.16666666666666666f), to_float2(0.465f, 0.20333333333333334f), to_float2(0.465f, 0.235f), to_float2(0.445f, 0.2633333333333333f), to_float2(0.4166666666666667f, 0.27f), to_float2(0.4166666666666667f, 0.235f), to_float2(0.42f, 0.2f), to_float2(0.42f, 0.16666666666666666f), to_float2(0.42f, 0.12833333333333333f), to_float2(0.42833333333333334f, 0.09166666666666666f), to_float2(0.445f, 0.03666666666666667f), to_float2(0.45666666666666667f, -0.011666666666666667f), to_float2(0.46f, -0.058333333333333334f), to_float2(0.46f, -0.095f), to_float2(0.46f, -0.13f), to_float2(0.46f, -0.16666666666666666f), to_float2(0.465f, -0.15833333333333333f), to_float2(0.465f, -0.12666666666666668f), to_float2(0.465f, -0.09f), to_float2(0.465f, -0.058333333333333334f), to_float2(0.4683333333333333f, -0.02666666666666667f), to_float2(0.48833333333333334f, 0.005f), to_float2(0.5116666666666667f, 0.013333333333333334f), to_float2(0.535f, -0.0033333333333333335f), to_float2(0.535f, -0.03833333333333333f), to_float2(0.535f, -0.07f), to_float2(0.535f, -0.10666666666666667f), to_float2(0.535f, -0.13833333333333334f), to_float2(0.555f, -0.16166666666666665f), to_float2(0.575f, -0.17333333333333334f), to_float2(0.595f, -0.15833333333333333f), to_float2(0.6116666666666667f, -0.13f), to_float2(0.615f, -0.08666666666666667f), to_float2(0.615f, -0.04666666666666667f), to_float2(0.615f, 0.005f), to_float2(0.615f, 0.03666666666666667f), to_float2(0.615f, 0.06833333333333333f), to_float2(0.615f, 0.1f), to_float2(0.6116666666666667f, 0.14f), to_float2(0.6033333333333334f, 0.175f), to_float2(0.6f, 0.20333333333333334f), to_float2(0.5833333333333334f, 0.235f), to_float2(0.575f, 0.25833333333333336f), to_float2(0.5516666666666666f, 0.275f), to_float2(0.5316666666666666f, 0.29f), to_float2(0.5116666666666667f, 0.315f), to_float2(0.49166666666666664f, 0.32666666666666666f), to_float2(0.4683333333333333f, 0.3383333333333333f), to_float2(0.43666666666666665f, 0.3383333333333333f), to_float2(0.405f, 0.3383333333333333f), to_float2(0.37333333333333335f, 0.3383333333333333f), to_float2(0.3416666666666667f, 0.3383333333333333f), to_float2(0.31f, 0.32166666666666666f), to_float2(0.2816666666666667f, 0.30666666666666664f), to_float2(0.25333333333333335f, 0.2833333333333333f), to_float2(0.235f, 0.2633333333333333f), to_float2(0.21f, 0.24333333333333335f), to_float2(0.19f, 0.21833333333333332f), to_float2(0.16666666666666666f, 0.20333333333333334f), to_float2(0.14666666666666667f, 0.18333333333333332f), to_float2(0.13166666666666665f, 0.16333333333333333f), to_float2(0.12333333333333334f, 0.13166666666666665f), to_float2(0.12333333333333334f, 0.13166666666666665f), to_float2(0.12333333333333334f, 0.16333333333333333f), to_float2(0.11166666666666666f, 0.195f), to_float2(0.08333333333333333f, 0.22333333333333333f), to_float2(0.06333333333333334f, 0.24666666666666667f), to_float2(0.035f, 0.27f), to_float2(0.011666666666666667f, 0.2633333333333333f), to_float2(0.008333333333333333f, 0.22333333333333333f), to_float2(0.0033333333333333335f, 0.19166666666666668f), to_float2(-0.008333333333333333f, 0.16f), to_float2(-0.02f, 0.14833333333333334f), to_float2(-0.02f, 0.18f), to_float2(-0.02f, 0.21166666666666667f), to_float2(-0.035f, 0.24333333333333335f), to_float2(-0.051666666666666666f, 0.26666666666666666f), to_float2(-0.07166666666666667f, 0.2866666666666667f), to_float2(-0.08666666666666667f, 0.3016666666666667f), to_float2(-0.10666666666666667f, 0.32166666666666666f), to_float2(-0.13833333333333334f, 0.32166666666666666f), to_float2(-0.175f, 0.32166666666666666f), to_float2(-0.20666666666666667f, 0.315f), to_float2(-0.23333333333333334f, 0.29833333333333334f), to_float2(-0.26166666666666666f, 0.2833333333333333f), to_float2(-0.29333333333333333f, 0.25833333333333336f), to_float2(-0.325f, 0.22666666666666666f), to_float2(-0.345f, 0.19166666666666668f), to_float2(-0.3566666666666667f, 0.155f)};
const float2 path[] = {{0.85f, -0.46f}, {-0.55f, 0.35f}, {-0.345f, 0.22666666666666666f}, {-0.3616666666666667f, 0.24333333333333335f}, {-0.3883333333333333f, 0.25f}, {-0.4166666666666667f, 0.255f}, {-0.4483333333333333f, 0.255f}, {-0.48f, 0.255f}, {-0.5116666666666667f, 0.255f}, {-0.54f, 0.25f}, {-0.56f, 0.235f}, {-0.5833333333333334f, 0.21166666666666667f}, {-0.6066666666666667f, 0.18666666666666668f}, {-0.6116666666666667f, 0.155f}, {-0.6116666666666667f, 0.12f}, {-0.6033333333333334f, 0.09166666666666666f}, {-0.5866666666666667f, 0.06f}, {-0.5666666666666667f, 0.04f}, {-0.5516666666666666f, 0.02f}, {-0.5316666666666666f, 0.0f}, {-0.5033333333333333f, -0.0033333333333333335f}, {-0.4716666666666667f, -0.0033333333333333335f}, {-0.44f, -0.0033333333333333335f}, {-0.44f, -0.0033333333333333335f}, {-0.4766666666666667f, -0.0033333333333333335f}, {-0.5083333333333333f, -0.015f}, {-0.5316666666666666f, -0.03166666666666667f}, {-0.5516666666666666f, -0.04666666666666667f}, {-0.5666666666666667f, -0.06333333333333334f}, {-0.5833333333333334f, -0.07833333333333334f}, {-0.595f, -0.09833333333333333f}, {-0.595f, -0.13333333333333333f}, {-0.58f, -0.16166666666666665f}, {-0.56f, -0.18166666666666667f}, {-0.5316666666666666f, -0.20166666666666666f}, {-0.48333333333333334f, -0.225f}, {-0.4483333333333333f, -0.24166666666666667f}, {-0.4166666666666667f, -0.245f}, {-0.385f, -0.245f}, {-0.325f, -0.23f}, {-0.2816666666666667f, -0.21333333333333335f}, {-0.25333333333333335f, -0.19f}, {-0.23f, -0.16166666666666665f}, {-0.21f, -0.13333333333333333f}, {-0.195f, -0.10166666666666667f}, {-0.17f, -0.075f}, {-0.14666666666666667f, -0.035f}, {-0.14333333333333334f, 0.0f}, {-0.13166666666666665f, 0.065f}, {-0.13166666666666665f, 0.09666666666666666f}, {-0.13166666666666665f, 0.12833333333333333f}, {-0.13166666666666665f, 0.16f}, {-0.13166666666666665f, 0.195f}, {-0.13833333333333334f, 0.22666666666666666f}, {-0.155f, 0.25f}, {-0.17833333333333334f, 0.2633333333333333f}, {-0.20166666666666666f, 0.24666666666666667f}, {-0.21f, 0.21166666666666667f}, {-0.21f, 0.175f}, {-0.20166666666666666f, 0.11666666666666667f}, {-0.20166666666666666f, 0.07166666666666667f}, {-0.20166666666666666f, 0.03666666666666667f}, {-0.20166666666666666f, 0.0f}, {-0.19833333333333333f, -0.035f}, {-0.18666666666666668f, -0.06333333333333334f}, {-0.175f, -0.09f}, {-0.16333333333333333f, -0.13f}, {-0.155f, -0.15833333333333333f}, {-0.14333333333333334f, -0.185f}, {-0.11833333333333333f, -0.205f}, {-0.10333333333333333f, -0.22166666666666668f}, {-0.075f, -0.21333333333333335f}, {-0.051666666666666666f, -0.18166666666666667f}, {-0.035f, -0.16166666666666665f}, {-0.03166666666666667f, -0.13333333333333333f}, {-0.023333333333333334f, -0.10166666666666667f}, {-0.011666666666666667f, -0.055f}, {-0.011666666666666667f, -0.023333333333333334f}, {-0.011666666666666667f, 0.013333333333333334f}, {-0.011666666666666667f, 0.045f}, {-0.011666666666666667f, 0.07666666666666666f}, {-0.011666666666666667f, 0.045f}, {-0.011666666666666667f, 0.008333333333333333f}, {-0.011666666666666667f, -0.02666666666666667f}, {-0.008333333333333333f, -0.06333333333333334f}, {0.011666666666666667f, -0.08666666666666667f}, {0.035f, -0.10166666666666667f}, {0.06f, -0.095f}, {0.08666666666666667f, -0.07f}, {0.10666666666666667f, -0.05f}, {0.11166666666666666f, -0.018333333333333333f}, {0.115f, 0.008333333333333333f}, {0.11833333333333333f, 0.03666666666666667f}, {0.11833333333333333f, 0.06833333333333333f}, {0.135f, 0.03666666666666667f}, {0.12333333333333334f, 0.008333333333333333f}, {0.11166666666666666f, -0.018333333333333333f}, {0.11166666666666666f, -0.05f}, {0.11166666666666666f, -0.08333333333333333f}, {0.11166666666666666f, -0.115f}, {0.11166666666666666f, -0.15333333333333332f}, {0.11166666666666666f, -0.19f}, {0.11166666666666666f, -0.23333333333333334f}, {0.11166666666666666f, -0.2683333333333333f}, {0.10666666666666667f, -0.3f}, {0.095f, -0.3333333333333333f}, {0.08333333333333333f, -0.365f}, {0.055f, -0.39166666666666666f}, {0.023333333333333334f, -0.4033333333333333f}, {0.0033333333333333335f, -0.37166666666666665f}, {0.0033333333333333335f, -0.34f}, {0.016666666666666666f, -0.31666666666666665f}, {0.04f, -0.285f}, {0.055f, -0.25666666666666665f}, {0.075f, -0.21666666666666667f}, {0.095f, -0.17f}, {0.10666666666666667f, -0.13833333333333334f}, {0.12666666666666668f, -0.09f}, {0.14666666666666667f, -0.058333333333333334f}, {0.17f, -0.03166666666666667f}, {0.195f, -0.006666666666666667f}, {0.215f, 0.016666666666666666f}, {0.235f, 0.03666666666666667f}, {0.26166666666666666f, 0.04833333333333333f}, {0.29333333333333333f, 0.04833333333333333f}, {0.285f, 0.051666666666666666f}, {0.25f, 0.045f}, {0.235f, 0.02f}, {0.23833333333333334f, -0.018333333333333333f}, {0.24666666666666667f, -0.058333333333333334f}, {0.26666666666666666f, -0.095f}, {0.29833333333333334f, -0.115f}, {0.3333333333333333f, -0.08333333333333333f}, {0.35f, -0.06333333333333334f}, {0.3566666666666667f, -0.02666666666666667f}, {0.3566666666666667f, 0.008333333333333333f}, {0.345f, 0.03666666666666667f}, {0.325f, 0.051666666666666666f}, {0.3016666666666667f, 0.065f}, {0.3333333333333333f, 0.06f}, {0.3566666666666667f, 0.045f}, {0.36833333333333335f, 0.013333333333333334f}, {0.36833333333333335f, -0.035f}, {0.36833333333333335f, -0.07f}, {0.37666666666666665f, -0.10166666666666667f}, {0.405f, -0.115f}, {0.4483333333333333f, -0.075f}, {0.46f, -0.03166666666666667f}, {0.4683333333333333f, 0.02f}, {0.4716666666666667f, 0.08f}, {0.4716666666666667f, 0.135f}, {0.4716666666666667f, 0.16666666666666666f}, {0.465f, 0.20333333333333334f}, {0.465f, 0.235f}, {0.445f, 0.2633333333333333f}, {0.4166666666666667f, 0.27f}, {0.4166666666666667f, 0.235f}, {0.42f, 0.2f}, {0.42f, 0.16666666666666666f}, {0.42f, 0.12833333333333333f}, {0.42833333333333334f, 0.09166666666666666f}, {0.445f, 0.03666666666666667f}, {0.45666666666666667f, -0.011666666666666667f}, {0.46f, -0.058333333333333334f}, {0.46f, -0.095f}, {0.46f, -0.13f}, {0.46f, -0.16666666666666666f}, {0.465f, -0.15833333333333333f}, {0.465f, -0.12666666666666668f}, {0.465f, -0.09f}, {0.465f, -0.058333333333333334f}, {0.4683333333333333f, -0.02666666666666667f}, {0.48833333333333334f, 0.005f}, {0.5116666666666667f, 0.013333333333333334f}, {0.535f, -0.0033333333333333335f}, {0.535f, -0.03833333333333333f}, {0.535f, -0.07f}, {0.535f, -0.10666666666666667f}, {0.535f, -0.13833333333333334f}, {0.555f, -0.16166666666666665f}, {0.575f, -0.17333333333333334f}, {0.595f, -0.15833333333333333f}, {0.6116666666666667f, -0.13f}, {0.615f, -0.08666666666666667f}, {0.615f, -0.04666666666666667f}, {0.615f, 0.005f}, {0.615f, 0.03666666666666667f}, {0.615f, 0.06833333333333333f}, {0.615f, 0.1f}, {0.6116666666666667f, 0.14f}, {0.6033333333333334f, 0.175f}, {0.6f, 0.20333333333333334f}, {0.5833333333333334f, 0.235f}, {0.575f, 0.25833333333333336f}, {0.5516666666666666f, 0.275f}, {0.5316666666666666f, 0.29f}, {0.5116666666666667f, 0.315f}, {0.49166666666666664f, 0.32666666666666666f}, {0.4683333333333333f, 0.3383333333333333f}, {0.43666666666666665f, 0.3383333333333333f}, {0.405f, 0.3383333333333333f}, {0.37333333333333335f, 0.3383333333333333f}, {0.3416666666666667f, 0.3383333333333333f}, {0.31f, 0.32166666666666666f}, {0.2816666666666667f, 0.30666666666666664f}, {0.25333333333333335f, 0.2833333333333333f}, {0.235f, 0.2633333333333333f}, {0.21f, 0.24333333333333335f}, {0.19f, 0.21833333333333332f}, {0.16666666666666666f, 0.20333333333333334f}, {0.14666666666666667f, 0.18333333333333332f}, {0.13166666666666665f, 0.16333333333333333f}, {0.12333333333333334f, 0.13166666666666665f}, {0.12333333333333334f, 0.13166666666666665f}, {0.12333333333333334f, 0.16333333333333333f}, {0.11166666666666666f, 0.195f}, {0.08333333333333333f, 0.22333333333333333f}, {0.06333333333333334f, 0.24666666666666667f}, {0.035f, 0.27f}, {0.011666666666666667f, 0.2633333333333333f}, {0.008333333333333333f, 0.22333333333333333f}, {0.0033333333333333335f, 0.19166666666666668f}, {-0.008333333333333333f, 0.16f}, {-0.02f, 0.14833333333333334f}, {-0.02f, 0.18f}, {-0.02f, 0.21166666666666667f}, {-0.035f, 0.24333333333333335f}, {-0.051666666666666666f, 0.26666666666666666f}, {-0.07166666666666667f, 0.2866666666666667f}, {-0.08666666666666667f, 0.3016666666666667f}, {-0.10666666666666667f, 0.32166666666666666f}, {-0.13833333333333334f, 0.32166666666666666f}, {-0.175f, 0.32166666666666666f}, {-0.20666666666666667f, 0.315f}, {-0.23333333333333334f, 0.29833333333333334f}, {-0.26166666666666666f, 0.2833333333333333f}, {-0.29333333333333333f, 0.25833333333333336f}, {-0.325f, 0.22666666666666666f}, {-0.345f, 0.19166666666666668f}, {-0.3566666666666667f, 0.155f}};
#define TAU 6.28318530718f

__DEVICE__ float sdLine(in float2 p, in float2 a, in float2 b) {
float zzzzzzzzzzzzzzzzzzz;    
    float2 pa = p - a, ba = b - a;
    float h = clamp(dot(pa, ba) / dot(ba, ba), 0.0f, 1.0f);
    return length(pa - ba * h);
}
// ----------------------------------------------------------------------------------
// - Buffer A                                                                       -
// ----------------------------------------------------------------------------------
// Connect Buffer A 'Previsualization: Buffer A' to iChannel0


/*
DFT (Discrete Fourier Transform)
The path or "signal" gets broken down into a set of constant wave patterns.
The DFT output is calculated once and then maintained for the rest of the animation.
*/

// Complex multiplication operator
#define cmul(a, b) (a.x * b.x - a.y * b.y, a.x * b.y + b.x * a.y)

__KERNEL__ void ComplexfourierepicyclesJipiFuse__Buffer_A(float4 fragColor, float2 fragCoord, float2 iResolution, int iFrame, sampler2D iChannel0)
{
    CONNECT_CHECKBOX0(Reset, 0);
    fragCoord+=0.5f;
float AAAAAAAAAAAAAAAAAAAAA;
    int2 iFragCoord = to_int2_cfloat(fragCoord);
    if (iFrame == 0 || Reset) {
        // Calculate the DFT of the path
        float N = (float)(sizeof(path));
        float k = fragCoord.x + 0.5f; // fragCoord strangely goes from 0.5f to resolution - 0.5f (according to the documentation)
        float2 sum = to_float2_s(0.0f);
        for (float n=0.0f; n < N; n++) {
            float phi = TAU / N * k * n;
            sum += cmul(path[(int)(n)], to_float2(_cosf(phi), -_sinf(phi)));
        }

        sum /= N;

        float phase = _atan2f(sum.y, sum.x);
        float amp = length(sum);
        float freq = k;

        swi3S(fragColor,x,y,z, to_float3(amp, freq, phase));
    }

    if (iFrame > 0 || Reset) {
        //fragColor = texelFetch(iChannel0, iFragCoord, 0); // Maintain buffer data
        fragColor = texture(iChannel0, (make_float2(iFragCoord)+0.5f)/iResolution); // Maintain buffer data
    }

  SetFragmentShaderComputedColor(fragColor);
}
// ----------------------------------------------------------------------------------
// - Buffer B                                                                       -
// ----------------------------------------------------------------------------------
// Connect Buffer B 'Previsualization: Buffer A' to iChannel0
// Connect Buffer B 'Previsualization: Buffer B' to iChannel1


// Visualization of the path as it is drawn
__KERNEL__ void ComplexfourierepicyclesJipiFuse__Buffer_B(float4 fragColor, float2 fragCoord, float2 iResolution, int iFrame, sampler2D iChannel0, sampler2D iChannel1)
{
    CONNECT_CHECKBOX0(Reset, 0);
  
    fragCoord+=0.5f;

    float2 uv = (fragCoord - 0.5f * iResolution) / iResolution.y;
    fragColor = texture(iChannel1, (make_float2(to_int2_cfloat(fragCoord))+0.5f)/iResolution);

    float unit = 2.0f / iResolution.y;

    float dt = TAU / (float)(sizeof(path));
    float t = (float)(iFrame) * dt;
    float tPrev = t - dt;

    // Calculate the previous and current positions
    float2 prevPos = to_float2_s(0.0f);
    float2 pos = to_float2_s(0.0f);
    //for (int n=0; n < path.length(); n++) {
    for (int n=0; n < sizeof(path); n++) {
        //float3 epicycle = texelFetch(iChannel0, to_int2(n, 0), 0).xyz;
        float3 epicycle = swi3(texture(iChannel0, (make_float2(to_int2(n, 0))+0.5f)/iResolution),x,y,z);
        float aPrev = tPrev * epicycle.y + epicycle.z;
        prevPos += to_float2(_cosf(aPrev), _sinf(aPrev)) * epicycle.x;

        float a = t * epicycle.y + epicycle.z;
        pos += to_float2(_cosf(a), _sinf(a)) * epicycle.x;
    }

    // Draw a new segment from the previous position to the current position
    swi3S(fragColor,x,y,z, _mix(swi3(fragColor,x,y,z), to_float3(0.0f, 1.0f, 0.0f), smoothstep(unit, 0.0f, sdLine(uv, prevPos, pos))));

    // Clear the buffer after the path has been completed
    //if (iFrame % path.length() == 0 || Reset) {
      if (iFrame % sizeof(path) == 0 || Reset) {
        fragColor = to_float4(0.0f, 0.0f, 0.0f, 1.0f);
    }

  SetFragmentShaderComputedColor(fragColor);
}
// ----------------------------------------------------------------------------------
// - Image                                                                          -
// ----------------------------------------------------------------------------------
// Connect Image 'Previsualization: Buffer A' to iChannel0
// Connect Image 'Previsualization: Buffer B' to iChannel1


/*
I have always wanted to make this and I finally did after watching The Coding Train's
videos about DFT (Discrete Fourier Transform). This was also my first time actually
going under the hood of complex numbers.
*/

__KERNEL__ void ComplexfourierepicyclesJipiFuse(float4 fragColor, float2 fragCoord, float2 iResolution, int iFrame, sampler2D iChannel0, sampler2D iChannel1)
{

    float2 uv = (fragCoord - 0.5f * iResolution) / iResolution.y;
    fragColor = texture(iChannel1, (make_float2(to_int2_cfloat(fragCoord))+0.5f)/iResolution);

    float unit = 2.0f / iResolution.y;

    // Time (t) and time step (dt)
    float dt = TAU / (float)(sizeof(path));
    float t = (float)(iFrame) * dt;
float IIIIIIIIIIIIIIIIII;
    // Draw each epicycle
    float2 pos = to_float2_s(0.0f);
    //for (int n=0; n < path.length(); n++) {
    for (int n=0; n < sizeof(path); n++) {
        float2 prevPos = pos;
        //float3 epicycle = texelFetch(iChannel0, to_int2(n, 0), 0).xyz;
        float3 epicycle = swi3(texture(iChannel0, (make_float2(to_int2(n, 0))+0.5f)/iResolution),x,y,z);
        swi3S(fragColor,x,y,z, _mix(swi3(fragColor,x,y,z), to_float3(1.0f, 1.0f, 1.0f), smoothstep(unit, 0.0f, _fabs(length(uv - pos) - epicycle.x))));

        float a = t * epicycle.y + epicycle.z;
        pos += to_float2(_cosf(a), _sinf(a)) * epicycle.x;
        swi3S(fragColor,x,y,z, _mix(swi3(fragColor,x,y,z), to_float3(1.0f, 1.0f, 1.0f), smoothstep(unit, 0.0f, sdLine(uv, prevPos, pos))));
    }

  SetFragmentShaderComputedColor(fragColor);
}