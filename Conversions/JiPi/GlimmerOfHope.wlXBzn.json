{"Shader":{"ver":"0.1","info":{"id":"wlXBzn","date":"1595815096","viewed":363,"name":"Glimmer of Hope","username":"wyatt","description":"I think digital art should be inspired by nature more, and less by technology. ","likes":18,"published":3,"flags":32,"usePreview":0,"tags":["nature"],"hasliked":0},"renderpass":[{"inputs":[{"id":258,"src":"\/media\/previz\/buffer01.png","ctype":"buffer","channel":1,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":260,"src":"\/media\/previz\/buffer03.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":37,"channel":0}],"code":"Main \n{\n    vec4 b = B(U);\n    Q = A(U);\n    for (float j = 0.; j < 6.2; j += 6.2\/3.)\n        for (float i = 0.; i < 7.; i++) {\n            vec4 a = A(U+vec2(i,0)*ei(j+.1*iTime));\n            Q += .5*a*(-1.+exp(8.*a))*gauss(i,3.);\n        }\n    Q = mix(vec4(.7,.7,.7,1)-b.zzzz+.1*Q,Q,2.*b.z);\n}","name":"Image","description":"","type":"image"},{"inputs":[],"outputs":[],"code":"#define R iResolution.xy\n#define A(U) texture(iChannel0,(U)\/R)\n#define B(U) texture(iChannel1,(U)\/R)\n#define C(U) texture(iChannel2,(U)\/R)\n#define D(U) texture(iChannel3,(U)\/R)\n#define Main void mainImage(out vec4 Q, in vec2 U)\nvec4 pw (vec4 t, float p) {\n\treturn vec4(pow(t.x,p),pow(t.y,p),pow(t.z,p),1);\n}\n#define ei(a) mat2(cos(a),-sin(a),sin(a),cos(a))\n#define gauss( i, std) 0.3989422804\/(std)*exp(-.5*(i)*(i)\/(std)\/(std))\n","name":"Common","description":"","type":"common"},{"inputs":[{"id":258,"src":"\/media\/previz\/buffer01.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":257,"channel":0}],"code":"Main \n{\n    Q = vec4(0);\n\tfor (int x = -1; x<=1; x++)\n\tfor (int y = -1; y<=1; y++)\n    {\n        vec2 u = vec2(x,y);\n        vec4 aa = A(U+u);\n        \n    \t#define q 1.5\n\t\tvec2 w1 = clamp(U+u+aa.xy-0.5*q,U - 0.5,U + 0.5),\n             w2 = clamp(U+u+aa.xy+0.5*q,U - 0.5,U + 0.5);\n        float m = (w2.x-w1.x)*(w2.y-w1.y)\/(q*q);\n        Q.xy += m*aa.z*aa.xy;\n        Q.z += m*aa.z;\n    }\n    if (Q.z>0.)\n    \tQ.xy\/=Q.z;\n    if (iFrame < 1) \n    {\n        Q = vec4(0,0,0,0);\n        if (length(U\/R-0.5)<0.4)Q.z = .8;\n    }\n    if (iMouse.z>0.&&length(U-iMouse.xy)<10.) Q.xz = vec2(.5,.5);\n    if (U.x<1.||U.y<1.||R.x-U.x<1.||R.y-U.y<1.) Q.xy *= 0.;\n}","name":"Buffer A","description":"","type":"buffer"},{"inputs":[{"id":7,"src":"\/media\/a\/fb918796edc3d2221218db0811e240e72e340350008338b0c07a52bd353666a6.jpg","ctype":"texture","channel":3,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":257,"src":"\/media\/previz\/buffer00.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":259,"src":"\/media\/previz\/buffer02.png","ctype":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":258,"channel":0}],"code":"Main \n{\n    Q = A(U);\n    vec4 c = C(U), d = D(c.xy);\n    float f = -.5*(d.x*2.-1.)-.5;\n\tfor (int x = -1; x<=1; x++)\n\tfor (int y = -1; y<=1; y++)\n    if (x != 0||y!=0)\n    {\n        vec2 u = vec2(x,y);\n        vec4 aa = A(U+u), cc = C(U+u), dd = D(cc.xy);\n        float ff = dd.x*3.-dd.z*2.;\n        Q.xy -= 0.125*aa.z*normalize(u)*aa.z*(ff-.8+aa.z);\n    }\n    Q.xy*=1.-.005*(d.z+d.x);\n    Q.y += 5e-4*Q.z*(d.y*2.-1.);\n    if (U.x<1.||U.y<1.||R.x-U.x<1.||R.y-U.y<1.) Q.xy *= 0.;\n\n    \n}","name":"Buffer B","description":"","type":"buffer"},{"inputs":[{"id":258,"src":"\/media\/previz\/buffer01.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":259,"src":"\/media\/previz\/buffer02.png","ctype":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":259,"channel":0}],"code":"Main \n{\n    Q = vec4(0);\n    float w = 0.;\n\tfor (int x = -1; x<=1; x++)\n\tfor (int y = -1; y<=1; y++)\n    {\n        vec2 u = vec2(x,y);\n        vec4 aa = A(U+u), cc = C(U+u), dd = D(cc.xy);\n        \n    \t#define q 1.\n\t\tvec2 w1 = clamp(U+u+aa.xy-0.5*q,U - 0.5,U + 0.5),\n             w2 = clamp(U+u+aa.xy+0.5*q,U - 0.5,U + 0.5);\n        float m = (w2.x-w1.x)*(w2.y-w1.y)\/(q*q);\n        Q += m*aa.z*cc;\n        w += m*aa.z;\n    }\n    if (w>0.)\n    \tQ\/=w;\n    Q.xy = mix(Q.xy,U,1e-5);\n    if (iFrame < 1) Q = vec4(U,0,0);\n}","name":"Buffer C","description":"","type":"buffer"},{"inputs":[{"id":7,"src":"\/media\/a\/fb918796edc3d2221218db0811e240e72e340350008338b0c07a52bd353666a6.jpg","ctype":"texture","channel":3,"sampler":{"filter":"mipmap","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":26,"src":"\/media\/a\/94284d43be78f00eb6b298e6d78656a1b34e2b91b34940d02f1ca8b22310e8a0.png","ctype":"cubemap","channel":1,"sampler":{"filter":"mipmap","wrap":"clamp","vflip":"false","srgb":"false","internal":"byte"},"published":1},{"id":258,"src":"\/media\/previz\/buffer01.png","ctype":"buffer","channel":0,"sampler":{"filter":"linear","wrap":"clamp","vflip":"true","srgb":"false","internal":"byte"},"published":1},{"id":259,"src":"\/media\/previz\/buffer02.png","ctype":"buffer","channel":2,"sampler":{"filter":"linear","wrap":"repeat","vflip":"true","srgb":"false","internal":"byte"},"published":1}],"outputs":[{"id":260,"channel":0}],"code":"Main {\n    vec4 a = A(U), c = C(U), d = D(c.xy);\n\tfloat std = d.x+d.y-2.*d.z;\n    \n  \tvec4\n        n = A(U+vec2(0,1)),\n        e = A(U+vec2(1,0)),\n        s = A(U-vec2(0,1)),\n        w = A(U-vec2(1,0));\n    vec3 norm = \n        normalize(vec3(e.z-w.z,n.z-s.z,-.01*(std*std)));\n    vec3 ref = reflect(vec3(0,0,1), norm);\n    Q = min(a.z,1.)*d*sqrt(d);\n    vec4 tx = texture(iChannel1,ref);\n    Q *= 0.5+0.5*tx+.1*norm.x;\n    Q *= exp(tx);\n    Q = atan(Q);\n}","name":"Buffer D","description":"","type":"buffer"}]}}